<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>I knew you would say yes!</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#f6dadb; --accent:#d32f2f; --ink:#2b2b2b; --paper:#fff8f6;
      --shadow:0 14px 28px rgba(0,0,0,.12); --green:#4caf50; --border:#f1d7d7;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{ margin:0; display:grid; place-items:center; background:var(--bg); color:var(--ink);
      font-family:'Poppins', system-ui, -apple-system, Segoe UI, Roboto, Arial; }
    .card{ background:var(--paper); border:1.5px solid var(--border); border-radius:18px; padding:32px 26px;
      width:min(720px,92vw); text-align:center; box-shadow: var(--shadow); position: relative; overflow: hidden; }
    h1{ font-family:'Playfair Display', serif; font-weight:700; color:var(--accent);
      font-size:clamp(28px,4vw,44px); line-height:1.25; margin:0 0 8px; letter-spacing:.5px; animation: pop .6s ease both; }
    @keyframes pop{from{transform:translateY(6px);opacity:0}to{transform:none;opacity:1}}
    .sub{ margin:10px auto 18px; font-size:clamp(15px,2.6vw,18px); line-height:1.7; }
    .spice{ color:#c2185b; font-weight:600; }
    .hint{ margin-top:8px; color:#6b4b4b; font-size:14px; }
    .big-heart{ font-size:42px; margin-top:6px; display:inline-block; animation: heartbeat 1.6s ease-in-out infinite; transform-origin:center; }
    @keyframes heartbeat{ 0%,40%,80%,100%{ transform:scale(1) } 20%{ transform:scale(1.12) } 60%{ transform:scale(1.07) } }
    .cta{ margin-top:20px; display:flex; gap:12px; justify-content:center; flex-wrap:wrap; }
    .btn{ border:0; border-radius:12px; padding:12px 16px; cursor:pointer; font-weight:600; font-size:16px; box-shadow:0 6px 14px rgba(0,0,0,.08); }
    .btn-primary{ background:var(--green); color:#fff } .btn-ghost{ background:#fff; color:#555; border:1px solid #e6caca }
    .btn:active{ transform:translateY(1px) }
    /* confetti */
    .confetti{ position:fixed; top:-12px; width:10px; height:14px; background:#ff6b6b; opacity:.95; z-index:9999; animation: fall linear forwards; border-radius:2px; }
    @keyframes fall{ to{ transform:translateY(100vh) rotate(360deg); opacity:0 } }
    .float-heart{ position:fixed; left:50%; top:52%; transform: translate(-50%,0); font-size:20px; opacity:0; pointer-events:none; animation: floatUp 1.2s ease forwards; }
    @keyframes floatUp{ from{ transform:translate(-50%,10px); opacity:0 } to{ transform:translate(-50%,-120px); opacity:1 } }
    /* popup */
    .choice-pop{ position: fixed; inset: 0; background: rgba(0,0,0,.45); display: none; place-items: center; z-index: 9999; }
    .choice-pop.show{ display: grid; }
    .choice-card{ background: var(--paper); border: 1.5px solid var(--border); border-radius: 16px; padding: 20px 18px;
      width: min(520px, 92vw); box-shadow: var(--shadow); text-align: center; animation: pop .35s ease both; }
    .choice-card h2{ margin: 0 0 8px; font-family: 'Playfair Display', serif; color: var(--accent); font-size: clamp(20px, 4.2vw, 28px); }
    .section-title{ margin: 10px 0 6px; font-weight: 600; color: #7a5656; font-size: 14px; text-transform: uppercase; letter-spacing: .12em; }
    .group{ display:flex; flex-wrap:wrap; gap:8px; justify-content:center; }
    .pill{ border:1px solid #e8caca; background:#fff; color:#5b4a4a; padding:10px 14px; border-radius:999px; cursor:pointer; font-weight:600; font-size:15px; transition: all .15s ease; box-shadow:0 6px 14px rgba(0,0,0,.06); user-select:none; }
    .pill:hover{ transform: translateY(-1px); }
    .pill.active{ background:#4caf50; color:#fff; border-color:#4caf50; }
    .choice-actions{ display:flex; gap:10px; justify-content:center; margin-top:14px; flex-wrap:wrap; }
  </style>
</head>
<body>
  <main class="card" aria-live="polite">
    <h1>I knew you‚Äôd say yes.</h1>
    <div class="sub" id="subcopy">
      Now let me spoil you tonight ‚Äî
      stay comfy, bring that <span class="spice">kiss-stealing smile</span>,
      and save me the seat right next to you. <br/>
    </div>
    <div class="big-heart">‚ù§Ô∏è</div>
    <div class="hint">Table‚Äôs ready. I‚Äôll handle the rest ‚Äî you just look irresistible.</div>

    <div class="cta">
      <button class="btn btn-primary" id="go" aria-haspopup="dialog" aria-controls="choice">Let‚Äôs go</button>
      <button class="btn btn-ghost" id="back">Back to invite</button>
    </div>
  </main>

  <!-- Choice Popup -->
  <div class="choice-pop" id="choice" role="dialog" aria-modal="true" aria-labelledby="choiceTitle">
    <div class="choice-card">
      <h2 id="choiceTitle">Where shall we go tonight?</h2>

      <div class="section-title">Pick a vibe</div>
      <div class="group places" id="placeGroup">
        <button class="pill" data-place="üåπ Romantic">üåπ Romantic</button>
        <button class="pill" data-place="üç∑ Chill drinks">üç∑ Chill drinks</button>
        <button class="pill" data-place="üç≤ Feast">üç≤ Feast</button>
      </div>

      <div class="section-title">Pick a time</div>
      <div class="group times" id="timeGroup">
        <button class="pill" data-time="7:30 PM">7:30 PM</button>
        <button class="pill" data-time="8:00 PM">8:00 PM</button>
        <button class="pill" data-time="8:15 PM">8:15 PM</button>
      </div>

      <div class="choice-actions">
        <button class="btn btn-primary" id="confirm">Confirm</button>
        <button class="btn btn-ghost" id="cancel">Cancel</button>
      </div>
    </div>
  </div>

  <script>
    // === Confetti & hearts ===
    const colors = ["#ff6b6b","#feca57","#48dbfb","#1dd1a1","#ff9ff3","#54a0ff","#5f27cd","#ffd93d"];
    function oneConfetti(){ const el=document.createElement('div'); el.className='confetti';
      el.style.left=Math.random()*100+'vw'; el.style.backgroundColor=colors[(Math.random()*colors.length)|0];
      el.style.width=(6+Math.random()*6)+'px'; el.style.height=(8+Math.random()*10)+'px';
      el.style.animationDuration=(3+Math.random()*2)+'s'; el.style.transform=`rotate(${Math.random()*360}deg)`;
      document.body.appendChild(el); setTimeout(()=> el.remove(), 5200); }
    function confettiSnow(durationMs=10000, everyMs=140){ const iv=setInterval(oneConfetti, everyMs); setTimeout(()=> clearInterval(iv), durationMs); }
    function burstHearts(){ const icons=["üíì","üíó","üíñ","üíû","üíò","‚ù§Ô∏è‚Äçüî•"]; for(let i=0;i<10;i++){ const h=document.createElement('div');
      h.className='float-heart'; h.textContent=icons[i%icons.length]; h.style.left=(50+(Math.random()*40-20))+'%';
      h.style.top=(58+(Math.random()*6-3))+'%'; h.style.animationDuration=(0.9+Math.random()*0.6)+'s';
      document.body.appendChild(h); setTimeout(()=> h.remove(), 1200);} }

    // read any existing query (?time, ?place) to show under the heading
    window.addEventListener('load', ()=>{
      confettiSnow(10000, 140); burstHearts();
      const params = new URLSearchParams(window.location.search);
      const t = params.get("time"); const p = params.get("place");
      if(t || p){
        const msg = `‚è∞ ${p ? p : ''}${p && t ? ' at ' : ''}${t ? t : ''}`;
        if(msg.trim()){
          document.getElementById("subcopy").insertAdjacentHTML("beforeend", `<br/><strong>${msg}</strong>`);
        }
      }
    });

    // navigation
    document.getElementById('back').addEventListener('click', ()=>{ window.location.href = 'index.html'; });

    // popup logic
    const popup = document.getElementById('choice');
    const goBtn = document.getElementById('go');
    const cancelBtn = document.getElementById('cancel');
    const confirmBtn = document.getElementById('confirm');
    const placeBtns = [...document.querySelectorAll('#placeGroup .pill')];
    const timeBtns  = [...document.querySelectorAll('#timeGroup  .pill')];

    let chosenPlace = null;
    let chosenTime  = null;

    function activate(btns, btn){ btns.forEach(b=>b.classList.remove('active')); btn.classList.add('active'); }

    placeBtns.forEach(b=> b.addEventListener('click', ()=>{ activate(placeBtns,b); chosenPlace=b.dataset.place; }));
    timeBtns.forEach(b=>  b.addEventListener('click', ()=>{ activate(timeBtns,b);  chosenTime=b.dataset.time;  }));

    goBtn.addEventListener('click', ()=>{
      popup.classList.add('show');
      if(!chosenPlace){ placeBtns[0].click(); }
      if(!chosenTime){ timeBtns[0].click(); }
    });
    cancelBtn.addEventListener('click', ()=> popup.classList.remove('show') );

    // ====== SEND CONFIRMATION TO YOU (optional) ======
    // Put your webhook / endpoint here (Discord/Slack/Google Apps Script, etc.).
    // If left empty, it will skip silently.
    const WEBHOOK_URL = ""; // e.g., "https://discord.com/api/webhooks/XXXX/XXXX"

    async function notifyOwner(place, time){
      if(!WEBHOOK_URL) return; // skip if not set
      const payload = {
        place, time,
        at: new Date().toISOString(),
        ua: navigator.userAgent
      };
      try{
        await fetch(WEBHOOK_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });
      }catch(e){ /* ignore errors silently */ }
    }

    confirmBtn.addEventListener('click', async ()=>{
      if(!chosenPlace || !chosenTime){ alert('Please pick a place and a time üíï'); return; }

      // show selection here immediately
      const sub = document.getElementById('subcopy');
      sub.insertAdjacentHTML("beforeend", `<br/><strong>‚è∞ ${chosenPlace} at ${chosenTime}</strong>`);

      // notify you
      await notifyOwner(chosenPlace, chosenTime);

      // go to countdown with params
      const qs = new URLSearchParams({ place: chosenPlace, time: chosenTime }).toString();
      window.location.href = `date_night.html?${qs}`;
    });

    // backdrop click & Esc to close
    popup.addEventListener('click', (e)=>{ if(e.target === popup) popup.classList.remove('show'); });
    document.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && popup.classList.contains('show')) popup.classList.remove('show'); });
  </script>
</body>
</html>
